{"ast":null,"code":"import { HTTP_LOGIN_FETCHING, HTTP_LOGIN_SUCCESS, HTTP_LOGIN_FAILED, server, OK, YES } from \"../constants\";\nimport { httpClient } from './../utils/HttpClient';\nexport const setLoginStateToFetching = () => ({\n  type: HTTP_LOGIN_FETCHING\n});\nexport const setLoginStateToSuccess = payload => ({\n  type: HTTP_LOGIN_SUCCESS,\n  payload\n});\nexport const setLoginStateToFailed = () => ({\n  type: HTTP_LOGIN_FAILED\n});\nexport const autologin = history => {\n  return () => {\n    if (localStorage.getItem(server.LOGIN_PASSED) == \"YES\") {\n      setTimeout(() => history.push(\"/stock\"), 100);\n    }\n  };\n};\nexport const login = (history, credential) => {\n  return async (dispatch, getState) => {\n    dispatch(setLoginStateToFetching());\n\n    try {\n      let result = await httpClient.post(server.LOGIN_URL, credential);\n\n      if (result.data.result == OK) {\n        //success\n        localStorage.setItem(server.LOGIN_PASSED, YES);\n        getState().appReducer.app.forceUpdate();\n        history.push(\"/stock\");\n        dispatch(setLoginStateToSuccess(result.data.result));\n      } else {\n        //failed\n        dispatch(setLoginStateToFailed());\n      }\n    } catch {\n      dispatch(setLoginStateToFailed());\n    }\n  };\n};","map":{"version":3,"sources":["/Users/rangsanchipphang/Documents/SourceCode/React/cmstock-react-js/src/actions/login.action.js"],"names":["HTTP_LOGIN_FETCHING","HTTP_LOGIN_SUCCESS","HTTP_LOGIN_FAILED","server","OK","YES","httpClient","setLoginStateToFetching","type","setLoginStateToSuccess","payload","setLoginStateToFailed","autologin","history","localStorage","getItem","LOGIN_PASSED","setTimeout","push","login","credential","dispatch","getState","result","post","LOGIN_URL","data","setItem","appReducer","app","forceUpdate"],"mappings":"AAAA,SAASA,mBAAT,EAA8BC,kBAA9B,EAAkDC,iBAAlD,EAAoEC,MAApE,EAA2EC,EAA3E,EAA+EC,GAA/E,QAA0F,cAA1F;AACA,SAASC,UAAT,QAA2B,uBAA3B;AAEA,OAAO,MAAMC,uBAAuB,GAAG,OAAO;AAC1CC,EAAAA,IAAI,EAAER;AADoC,CAAP,CAAhC;AAIP,OAAO,MAAMS,sBAAsB,GAAIC,OAAD,KAAc;AAChDF,EAAAA,IAAI,EAAEP,kBAD0C;AAEhDS,EAAAA;AAFgD,CAAd,CAA/B;AAKP,OAAO,MAAMC,qBAAqB,GAAG,OAAO;AACxCH,EAAAA,IAAI,EAAEN;AADkC,CAAP,CAA9B;AAIP,OAAO,MAAMU,SAAS,GAAGC,OAAD,IAAW;AAC/B,SAAO,MAAI;AACP,QAAGC,YAAY,CAACC,OAAb,CAAqBZ,MAAM,CAACa,YAA5B,KAA2C,KAA9C,EAAoD;AAChDC,MAAAA,UAAU,CAAC,MAAIJ,OAAO,CAACK,IAAR,CAAa,QAAb,CAAL,EAA4B,GAA5B,CAAV;AACH;AACJ,GAJD;AAKH,CANM;AAQP,OAAO,MAAMC,KAAK,GAAG,CAACN,OAAD,EAASO,UAAT,KAAsB;AACvC,SAAO,OAAOC,QAAP,EAAgBC,QAAhB,KAA2B;AAC9BD,IAAAA,QAAQ,CAACd,uBAAuB,EAAxB,CAAR;;AACA,QAAG;AACC,UAAIgB,MAAM,GAAE,MAAMjB,UAAU,CAACkB,IAAX,CAAgBrB,MAAM,CAACsB,SAAvB,EAAiCL,UAAjC,CAAlB;;AACA,UAAGG,MAAM,CAACG,IAAP,CAAYH,MAAZ,IAAqBnB,EAAxB,EAA2B;AACvB;AACAU,QAAAA,YAAY,CAACa,OAAb,CAAqBxB,MAAM,CAACa,YAA5B,EAAyCX,GAAzC;AACAiB,QAAAA,QAAQ,GAAGM,UAAX,CAAsBC,GAAtB,CAA0BC,WAA1B;AACAjB,QAAAA,OAAO,CAACK,IAAR,CAAa,QAAb;AACAG,QAAAA,QAAQ,CAACZ,sBAAsB,CAACc,MAAM,CAACG,IAAP,CAAYH,MAAb,CAAvB,CAAR;AACH,OAND,MAMK;AACD;AACAF,QAAAA,QAAQ,CAACV,qBAAqB,EAAtB,CAAR;AACH;AACJ,KAZD,CAaA,MAAK;AACDU,MAAAA,QAAQ,CAACV,qBAAqB,EAAtB,CAAR;AACH;AACJ,GAlBD;AAmBH,CApBM","sourcesContent":["import { HTTP_LOGIN_FETCHING, HTTP_LOGIN_SUCCESS, HTTP_LOGIN_FAILED,server,OK, YES } from \"../constants\";\nimport { httpClient } from './../utils/HttpClient';\n\nexport const setLoginStateToFetching = () => ({\n    type: HTTP_LOGIN_FETCHING,\n})\n\nexport const setLoginStateToSuccess = (payload) => ({\n    type: HTTP_LOGIN_SUCCESS,\n    payload\n})\n\nexport const setLoginStateToFailed = () => ({\n    type: HTTP_LOGIN_FAILED,\n})\n\nexport const autologin =(history)=>{\n    return ()=>{\n        if(localStorage.getItem(server.LOGIN_PASSED)==\"YES\"){\n            setTimeout(()=>history.push(\"/stock\"),100);\n        }\n    }\n}\n\nexport const login = (history,credential)=>{\n    return async (dispatch,getState)=>{\n        dispatch(setLoginStateToFetching())\n        try{\n            let result =await httpClient.post(server.LOGIN_URL,credential)\n            if(result.data.result ==OK){\n                //success\n                localStorage.setItem(server.LOGIN_PASSED,YES);\n                getState().appReducer.app.forceUpdate();\n                history.push(\"/stock\");\n                dispatch(setLoginStateToSuccess(result.data.result))               \n            }else{\n                //failed\n                dispatch(setLoginStateToFailed())\n            }\n        }\n        catch{\n            dispatch(setLoginStateToFailed())\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}